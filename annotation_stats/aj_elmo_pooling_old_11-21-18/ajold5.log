Namespace(batch_size=32, buffer_size=1, by_source=False, crop_pad_length=30, data='./acceptability_corpus/tokenized/run_mixed_dev/', data_type='discriminator', dropout=0.2, embedding='glove.840B.300d', embedding_path='/scratch/asw462/models/elmo_encoder/elmo.emb', embedding_size=217, encoder_num_layers=2, encoder_path='/scratch/asw462/models/elmo_encoder/elmo.pth', encoding_size=528, encoding_type='lstm_pooling_classifier', epochs=1000, evaluate_train=False, experiment_name='ajold5', glove=False, gpu=True, hidden_size=256, imbalance=True, learning_rate=5e-05, lm_path=None, logs_dir='/scratch/asw462/logs/aj_elmo_pooling_old_11-21-18', max_pool=False, model='linear_classifier', num_layers=1, output_dir='/scratch/asw462/logs/aj_elmo_pooling_old_11-21-18/outputs', patience=20, preprocess_tokenizer='space', prints_per_stage=1, resume=True, resume_file=None, save_loc='/scratch/asw462/models/aj_elmo_pooling_old_11-21-18', seed=1111, should_not_log=False, should_not_lowercase=False, should_not_preprocess_data=False, stages_per_epoch=2, train_embeddings=False, train_evaluate_interval=10, vocab_file='/scratch/asw462/data/vocab_100k.tsv')
======== General =======
Model: linear_classifier
GPU: True
Experiment Name: ajold5
Save location: /scratch/asw462/models/aj_elmo_pooling_old_11-21-18
Logs dir: /scratch/asw462/logs/aj_elmo_pooling_old_11-21-18
Timestamp: 2018/11/21 14:44:45
 
======== Data =======
Training set: 8551 examples
Validation set: 1043 examples
Test set: 1043 examples
 
======= Parameters =======
Learning Rate: 0.000050
Batch Size: 32
Epochs: 1000
Patience: 20
Stages per Epoch: 2
Embedding: 100004 x 217
Number of layers: 1
Hidden Size: 256
Encoder Size: 528
Resume: True
 
======= Model =======
LinearClassifierWithEncoder(
  (model): LinearClassifier(
    (dropout): Dropout(p=0.2)
    (enc2h): Linear(in_features=1056, out_features=256, bias=True)
    (h20): Linear(in_features=256, out_features=1, bias=True)
    (sigmoid): Sigmoid()
    (tanh): Tanh()
    (softmax): Softmax()
  )
  (encoder): LSTMPoolingClassifierWithELMo(
    (elmo): ELMOClassifier(
      (lm): LSTMLanguageModel(
        (dropout): Dropout(p=0.2)
        (embedding): Embedding(100003, 217)
        (lstm): LSTM(217, 891, num_layers=2, dropout=0.2)
        (fc): Linear(in_features=891, out_features=100003, bias=True)
      )
      (lstms): ModuleList(
        (0): LSTM(217, 891, batch_first=True)
        (1): LSTM(891, 891, batch_first=True)
      )
      (dropout): Dropout(p=0.2)
      (linear_comb): Linear(in_features=2, out_features=1, bias=True)
      (fc1): Linear(in_features=891, out_features=528, bias=True)
      (relu): ReLU()
      (out): Linear(in_features=528, out_features=1, bias=True)
      (sigmoid): Sigmoid()
    )
    (pooling_classifier): LSTMPoolingClassifier(
      (ih2h): LSTM(891, 528, num_layers=3, batch_first=True, dropout=0.2, bidirectional=True)
      (pool2o): Linear(in_features=1056, out_features=1, bias=True)
      (sigmoid): Sigmoid()
      (softmax): Softmax()
      (dropout): Dropout(p=0.2)
    )
  )
)
 
========= Epoch 1 =========
134/268: Matthews 0.22615, Accuracy: 66.53883, Loss: 0.004652865
268/268: Matthews 0.22953, Accuracy: 66.15532, Loss: 0.004518005
 
Best Matthews: 0.22953, Best Accuracy: 66.15532, Best Loss: 0.004518005 at epoch 1
Time Elasped: 00:00:24
========= Epoch 2 =========
134/268: Matthews 0.24656, Accuracy: 63.56663, Loss: 0.004423312
268/268: Matthews 0.25755, Accuracy: 67.49760, Loss: 0.004347803
 
Best Matthews: 0.25755, Best Accuracy: 67.49760, Best Loss: 0.004347803 at epoch 2
Time Elasped: 00:00:42
========= Epoch 3 =========
134/268: Matthews 0.27097, Accuracy: 67.59348, Loss: 0.004323719
268/268: Matthews 0.27339, Accuracy: 68.55225, Loss: 0.004299868
 
Best Matthews: 0.27339, Best Accuracy: 68.55225, Best Loss: 0.004299868 at epoch 3
Time Elasped: 00:01:01
========= Epoch 4 =========
134/268: Matthews 0.27834, Accuracy: 67.97699, Loss: 0.004319441
268/268: Matthews 0.27205, Accuracy: 64.42953, Loss: 0.004413083
 
Best Matthews: 0.27834, Best Accuracy: 67.97699, Best Loss: 0.004319441 at epoch 4
Time Elasped: 00:01:17
========= Epoch 5 =========
134/268: Matthews 0.26667, Accuracy: 66.15532, Loss: 0.004304919
268/268: Matthews 0.28036, Accuracy: 68.74401, Loss: 0.004228496
 
Best Matthews: 0.28036, Best Accuracy: 68.74401, Best Loss: 0.004228496 at epoch 5
Time Elasped: 00:01:34
========= Epoch 6 =========
134/268: Matthews 0.27465, Accuracy: 67.40173, Loss: 0.004257908
268/268: Matthews 0.28116, Accuracy: 67.20997, Loss: 0.004281660
 
Best Matthews: 0.28116, Best Accuracy: 67.20997, Best Loss: 0.004281660 at epoch 6
Time Elasped: 00:01:51
========= Epoch 7 =========
134/268: Matthews 0.29994, Accuracy: 69.99041, Loss: 0.004248627
268/268: Matthews 0.28374, Accuracy: 65.77181, Loss: 0.004347259
 
Best Matthews: 0.29994, Best Accuracy: 69.99041, Best Loss: 0.004248627 at epoch 7
Time Elasped: 00:02:08
========= Epoch 8 =========
134/268: Matthews 0.27881, Accuracy: 67.49760, Loss: 0.004271259
268/268: Matthews 0.28358, Accuracy: 66.73058, Loss: 0.004299146
 
Best Matthews: 0.29994, Best Accuracy: 69.99041, Best Loss: 0.004248627 at epoch 7
Time Elasped: 00:02:23
========= Epoch 9 =========
134/268: Matthews 0.29264, Accuracy: 67.78523, Loss: 0.004350860
268/268: Matthews 0.29853, Accuracy: 68.16874, Loss: 0.004320325
 
Best Matthews: 0.29994, Best Accuracy: 69.99041, Best Loss: 0.004248627 at epoch 7
Time Elasped: 00:02:38
========= Epoch 10 =========
134/268: Matthews 0.28184, Accuracy: 68.36050, Loss: 0.004290778
268/268: Matthews 0.28421, Accuracy: 68.26462, Loss: 0.004305647
 
Best Matthews: 0.29994, Best Accuracy: 69.99041, Best Loss: 0.004248627 at epoch 7
Time Elasped: 00:02:53
========= Epoch 11 =========
134/268: Matthews 0.28211, Accuracy: 67.88111, Loss: 0.004312605
268/268: Matthews 0.29766, Accuracy: 66.53883, Loss: 0.004359155
 
Best Matthews: 0.29994, Best Accuracy: 69.99041, Best Loss: 0.004248627 at epoch 7
Time Elasped: 00:03:08
========= Epoch 12 =========
134/268: Matthews 0.29779, Accuracy: 67.49760, Loss: 0.004347226
268/268: Matthews 0.30341, Accuracy: 67.68936, Loss: 0.004412605
 
Best Matthews: 0.30341, Best Accuracy: 67.68936, Best Loss: 0.004412605 at epoch 12
Time Elasped: 00:03:25
========= Epoch 13 =========
134/268: Matthews 0.29338, Accuracy: 66.63471, Loss: 0.004387163
268/268: Matthews 0.28320, Accuracy: 68.83988, Loss: 0.004447400
 
Best Matthews: 0.30341, Best Accuracy: 67.68936, Best Loss: 0.004412605 at epoch 12
Time Elasped: 00:03:40
========= Epoch 14 =========
134/268: Matthews 0.29759, Accuracy: 66.82646, Loss: 0.004432528
268/268: Matthews 0.29620, Accuracy: 67.01822, Loss: 0.004419780
 
Best Matthews: 0.30341, Best Accuracy: 67.68936, Best Loss: 0.004412605 at epoch 12
Time Elasped: 00:03:55
========= Epoch 15 =========
134/268: Matthews 0.27248, Accuracy: 67.68936, Loss: 0.004378904
268/268: Matthews 0.29901, Accuracy: 67.11409, Loss: 0.004419416
 
Best Matthews: 0.30341, Best Accuracy: 67.68936, Best Loss: 0.004412605 at epoch 12
Time Elasped: 00:04:10
========= Epoch 16 =========
134/268: Matthews 0.28138, Accuracy: 67.40173, Loss: 0.004428662
268/268: Matthews 0.29856, Accuracy: 65.58006, Loss: 0.004537888
 
Best Matthews: 0.30341, Best Accuracy: 67.68936, Best Loss: 0.004412605 at epoch 12
Time Elasped: 00:04:25
========= Epoch 17 =========
134/268: Matthews 0.28552, Accuracy: 68.26462, Loss: 0.004507074
268/268: Matthews 0.27398, Accuracy: 66.82646, Loss: 0.004423688
 
Best Matthews: 0.30341, Best Accuracy: 67.68936, Best Loss: 0.004412605 at epoch 12
Time Elasped: 00:04:39
========= Epoch 18 =========
134/268: Matthews 0.28943, Accuracy: 67.30585, Loss: 0.004395819
268/268: Matthews 0.28235, Accuracy: 68.55225, Loss: 0.004433173
 
Best Matthews: 0.30341, Best Accuracy: 67.68936, Best Loss: 0.004412605 at epoch 12
Time Elasped: 00:04:54
========= Epoch 19 =========
134/268: Matthews 0.28787, Accuracy: 67.01822, Loss: 0.004535435
268/268: Matthews 0.31046, Accuracy: 66.73058, Loss: 0.004502424
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:05:10
========= Epoch 20 =========
134/268: Matthews 0.29556, Accuracy: 69.51103, Loss: 0.004419512
268/268: Matthews 0.29361, Accuracy: 67.40173, Loss: 0.004483871
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:05:25
========= Epoch 21 =========
134/268: Matthews 0.28670, Accuracy: 67.30585, Loss: 0.004455299
268/268: Matthews 0.28467, Accuracy: 68.45638, Loss: 0.004507726
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:05:39
========= Epoch 22 =========
134/268: Matthews 0.27762, Accuracy: 67.59348, Loss: 0.004416084
268/268: Matthews 0.28511, Accuracy: 67.01822, Loss: 0.004543770
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:05:54
========= Epoch 23 =========
134/268: Matthews 0.29574, Accuracy: 68.74401, Loss: 0.004471230
268/268: Matthews 0.28380, Accuracy: 67.11409, Loss: 0.004484199
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:06:08
========= Epoch 24 =========
134/268: Matthews 0.29060, Accuracy: 66.92234, Loss: 0.004436803
268/268: Matthews 0.28552, Accuracy: 68.26462, Loss: 0.004457276
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:06:23
========= Epoch 25 =========
134/268: Matthews 0.28802, Accuracy: 68.74401, Loss: 0.004489389
268/268: Matthews 0.29488, Accuracy: 69.31927, Loss: 0.004408770
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:06:37
========= Epoch 26 =========
134/268: Matthews 0.29432, Accuracy: 69.51103, Loss: 0.004434183
268/268: Matthews 0.29558, Accuracy: 67.97699, Loss: 0.004450618
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:06:52
========= Epoch 27 =========
134/268: Matthews 0.28106, Accuracy: 68.55225, Loss: 0.004488420
268/268: Matthews 0.29759, Accuracy: 66.92234, Loss: 0.004476300
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:07:07
========= Epoch 28 =========
134/268: Matthews 0.29646, Accuracy: 69.41515, Loss: 0.004397174
268/268: Matthews 0.29692, Accuracy: 67.97699, Loss: 0.004561209
 
Best Matthews: 0.31046, Best Accuracy: 66.73058, Best Loss: 0.004502424 at epoch 19
Time Elasped: 00:07:21
========= Epoch 29 =========
134/268: Matthews 0.31670, Accuracy: 68.74401, Loss: 0.004436043
268/268: Matthews 0.29552, Accuracy: 69.12752, Loss: 0.004407287
 
Best Matthews: 0.31670, Best Accuracy: 68.74401, Best Loss: 0.004436043 at epoch 29
Time Elasped: 00:07:37
========= Epoch 30 =========
134/268: Matthews 0.29202, Accuracy: 67.01822, Loss: 0.004403565
268/268: Matthews 0.32818, Accuracy: 66.63471, Loss: 0.004482778
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:07:53
========= Epoch 31 =========
134/268: Matthews 0.30604, Accuracy: 67.40173, Loss: 0.004474253
268/268: Matthews 0.28099, Accuracy: 68.93576, Loss: 0.004436460
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:08:08
========= Epoch 32 =========
134/268: Matthews 0.28945, Accuracy: 68.26462, Loss: 0.004376212
268/268: Matthews 0.29190, Accuracy: 68.16874, Loss: 0.004392376
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:08:22
========= Epoch 33 =========
134/268: Matthews 0.30711, Accuracy: 68.55225, Loss: 0.004395240
268/268: Matthews 0.29708, Accuracy: 69.22339, Loss: 0.004325541
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:08:37
========= Epoch 34 =========
134/268: Matthews 0.30330, Accuracy: 67.49760, Loss: 0.004474732
268/268: Matthews 0.29514, Accuracy: 67.59348, Loss: 0.004353118
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:08:51
========= Epoch 35 =========
134/268: Matthews 0.30181, Accuracy: 67.11409, Loss: 0.004418689
268/268: Matthews 0.26597, Accuracy: 68.93576, Loss: 0.004357592
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:09:06
========= Epoch 36 =========
134/268: Matthews 0.28597, Accuracy: 68.45638, Loss: 0.004446785
268/268: Matthews 0.29804, Accuracy: 67.78523, Loss: 0.004429065
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:09:21
========= Epoch 37 =========
134/268: Matthews 0.32189, Accuracy: 65.96357, Loss: 0.004497749
268/268: Matthews 0.28814, Accuracy: 68.26462, Loss: 0.004342372
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:09:36
========= Epoch 38 =========
134/268: Matthews 0.28400, Accuracy: 68.16874, Loss: 0.004376767
268/268: Matthews 0.28679, Accuracy: 67.40173, Loss: 0.004330091
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:09:51
========= Epoch 39 =========
134/268: Matthews 0.28690, Accuracy: 67.49760, Loss: 0.004372820
268/268: Matthews 0.29096, Accuracy: 68.36050, Loss: 0.004375530
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:10:05
========= Epoch 40 =========
134/268: Matthews 0.29073, Accuracy: 67.20997, Loss: 0.004372792
268/268: Matthews 0.30781, Accuracy: 66.44295, Loss: 0.004402540
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:10:20
========= Epoch 41 =========
134/268: Matthews 0.29206, Accuracy: 67.11409, Loss: 0.004443676
268/268: Matthews 0.29341, Accuracy: 68.83988, Loss: 0.004375226
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:10:35
========= Epoch 42 =========
134/268: Matthews 0.28574, Accuracy: 68.36050, Loss: 0.004452176
268/268: Matthews 0.30009, Accuracy: 68.93576, Loss: 0.004372909
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:10:49
========= Epoch 43 =========
134/268: Matthews 0.27932, Accuracy: 66.05944, Loss: 0.004395561
268/268: Matthews 0.29506, Accuracy: 67.49760, Loss: 0.004331911
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:11:04
========= Epoch 44 =========
134/268: Matthews 0.29190, Accuracy: 68.16874, Loss: 0.004397771
268/268: Matthews 0.28794, Accuracy: 68.16874, Loss: 0.004411724
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:11:18
========= Epoch 45 =========
134/268: Matthews 0.30749, Accuracy: 67.59348, Loss: 0.004404871
268/268: Matthews 0.28511, Accuracy: 67.01822, Loss: 0.004374494
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:11:33
========= Epoch 46 =========
134/268: Matthews 0.31226, Accuracy: 65.48418, Loss: 0.004449660
268/268: Matthews 0.28985, Accuracy: 68.93576, Loss: 0.004404241
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:11:48
========= Epoch 47 =========
134/268: Matthews 0.30221, Accuracy: 67.88111, Loss: 0.004504848
268/268: Matthews 0.29187, Accuracy: 68.74401, Loss: 0.004432137
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:12:02
========= Epoch 48 =========
134/268: Matthews 0.29911, Accuracy: 67.40173, Loss: 0.004437597
268/268: Matthews 0.26472, Accuracy: 68.93576, Loss: 0.004438884
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:12:17
========= Epoch 49 =========
134/268: Matthews 0.29966, Accuracy: 65.86769, Loss: 0.004474291
268/268: Matthews 0.28704, Accuracy: 68.36050, Loss: 0.004433919
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:12:31
========= Epoch 50 =========
134/268: Matthews 0.30052, Accuracy: 66.53883, Loss: 0.004530489
268/268: Matthews 0.29455, Accuracy: 68.16874, Loss: 0.004462108
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:12:46
========= Epoch 51 =========
Early Stopping activated
 
Best Matthews: 0.32818, Best Accuracy: 66.63471, Best Loss: 0.004482778 at epoch 30
Time Elasped: 00:12:55
Test Set:
0/0: Matthews 0.32818, Accuracy: 66.63471, Loss: 0.004482778
