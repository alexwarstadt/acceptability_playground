Namespace(batch_size=32, buffer_size=1, by_source=False, crop_pad_length=30, data='./acceptability_corpus/tokenized/run_mixed_dev/', data_type='discriminator', dropout=0.2, embedding='glove.840B.300d', embedding_path='/scratch/asw462/models/elmo_encoder/elmo.emb', embedding_size=217, encoder_num_layers=2, encoder_path='/scratch/asw462/models/elmo_encoder/elmo.pth', encoding_size=528, encoding_type='lstm_pooling_classifier', epochs=1000, evaluate_train=False, experiment_name='ajold2', glove=False, gpu=True, hidden_size=256, imbalance=True, learning_rate=7e-05, lm_path=None, logs_dir='/scratch/asw462/logs/aj_elmo_pooling_old_11-21-18', max_pool=False, model='linear_classifier', num_layers=1, output_dir='/scratch/asw462/logs/aj_elmo_pooling_old_11-21-18/outputs', patience=20, preprocess_tokenizer='space', prints_per_stage=1, resume=True, resume_file=None, save_loc='/scratch/asw462/models/aj_elmo_pooling_old_11-21-18', seed=1111, should_not_log=False, should_not_lowercase=False, should_not_preprocess_data=False, stages_per_epoch=2, train_embeddings=False, train_evaluate_interval=10, vocab_file='/scratch/asw462/data/vocab_100k.tsv')
======== General =======
Model: linear_classifier
GPU: True
Experiment Name: ajold2
Save location: /scratch/asw462/models/aj_elmo_pooling_old_11-21-18
Logs dir: /scratch/asw462/logs/aj_elmo_pooling_old_11-21-18
Timestamp: 2018/11/21 14:44:45
 
======== Data =======
Training set: 8551 examples
Validation set: 1043 examples
Test set: 1043 examples
 
======= Parameters =======
Learning Rate: 0.000070
Batch Size: 32
Epochs: 1000
Patience: 20
Stages per Epoch: 2
Embedding: 100004 x 217
Number of layers: 1
Hidden Size: 256
Encoder Size: 528
Resume: True
 
======= Model =======
LinearClassifierWithEncoder(
  (model): LinearClassifier(
    (dropout): Dropout(p=0.2)
    (enc2h): Linear(in_features=1056, out_features=256, bias=True)
    (h20): Linear(in_features=256, out_features=1, bias=True)
    (sigmoid): Sigmoid()
    (tanh): Tanh()
    (softmax): Softmax()
  )
  (encoder): LSTMPoolingClassifierWithELMo(
    (elmo): ELMOClassifier(
      (lm): LSTMLanguageModel(
        (dropout): Dropout(p=0.2)
        (embedding): Embedding(100003, 217)
        (lstm): LSTM(217, 891, num_layers=2, dropout=0.2)
        (fc): Linear(in_features=891, out_features=100003, bias=True)
      )
      (lstms): ModuleList(
        (0): LSTM(217, 891, batch_first=True)
        (1): LSTM(891, 891, batch_first=True)
      )
      (dropout): Dropout(p=0.2)
      (linear_comb): Linear(in_features=2, out_features=1, bias=True)
      (fc1): Linear(in_features=891, out_features=528, bias=True)
      (relu): ReLU()
      (out): Linear(in_features=528, out_features=1, bias=True)
      (sigmoid): Sigmoid()
    )
    (pooling_classifier): LSTMPoolingClassifier(
      (ih2h): LSTM(891, 528, num_layers=3, batch_first=True, dropout=0.2, bidirectional=True)
      (pool2o): Linear(in_features=1056, out_features=1, bias=True)
      (sigmoid): Sigmoid()
      (softmax): Softmax()
      (dropout): Dropout(p=0.2)
    )
  )
)
 
========= Epoch 1 =========
134/268: Matthews 0.22913, Accuracy: 65.86769, Loss: 0.004591934
268/268: Matthews 0.25036, Accuracy: 66.44295, Loss: 0.004448519
 
Best Matthews: 0.25036, Best Accuracy: 66.44295, Best Loss: 0.004448519 at epoch 1
Time Elasped: 00:00:24
========= Epoch 2 =========
134/268: Matthews 0.24814, Accuracy: 62.70374, Loss: 0.004373441
268/268: Matthews 0.26588, Accuracy: 67.68936, Loss: 0.004298067
 
Best Matthews: 0.26588, Best Accuracy: 67.68936, Best Loss: 0.004298067 at epoch 2
Time Elasped: 00:00:41
========= Epoch 3 =========
134/268: Matthews 0.26548, Accuracy: 67.49760, Loss: 0.004283276
268/268: Matthews 0.28262, Accuracy: 68.64813, Loss: 0.004274440
 
Best Matthews: 0.28262, Best Accuracy: 68.64813, Best Loss: 0.004274440 at epoch 3
Time Elasped: 00:00:57
========= Epoch 4 =========
134/268: Matthews 0.27144, Accuracy: 67.01822, Loss: 0.004332879
268/268: Matthews 0.28184, Accuracy: 64.04602, Loss: 0.004442492
 
Best Matthews: 0.28262, Best Accuracy: 68.64813, Best Loss: 0.004274440 at epoch 3
Time Elasped: 00:01:12
========= Epoch 5 =========
134/268: Matthews 0.27937, Accuracy: 66.63471, Loss: 0.004298033
268/268: Matthews 0.27883, Accuracy: 69.03164, Loss: 0.004236652
 
Best Matthews: 0.28262, Best Accuracy: 68.64813, Best Loss: 0.004274440 at epoch 3
Time Elasped: 00:01:28
========= Epoch 6 =========
134/268: Matthews 0.28552, Accuracy: 68.26462, Loss: 0.004268424
268/268: Matthews 0.28943, Accuracy: 67.30585, Loss: 0.004293952
 
Best Matthews: 0.28943, Best Accuracy: 67.30585, Best Loss: 0.004293952 at epoch 6
Time Elasped: 00:01:46
========= Epoch 7 =========
134/268: Matthews 0.30126, Accuracy: 70.27804, Loss: 0.004283384
268/268: Matthews 0.28690, Accuracy: 65.48418, Loss: 0.004390407
 
Best Matthews: 0.30126, Best Accuracy: 70.27804, Best Loss: 0.004283384 at epoch 7
Time Elasped: 00:02:03
========= Epoch 8 =========
134/268: Matthews 0.29024, Accuracy: 67.97699, Loss: 0.004299092
268/268: Matthews 0.30041, Accuracy: 67.11409, Loss: 0.004353564
 
Best Matthews: 0.30126, Best Accuracy: 70.27804, Best Loss: 0.004283384 at epoch 7
Time Elasped: 00:02:18
========= Epoch 9 =========
134/268: Matthews 0.29487, Accuracy: 67.20997, Loss: 0.004407243
268/268: Matthews 0.29706, Accuracy: 68.07287, Loss: 0.004345311
 
Best Matthews: 0.30126, Best Accuracy: 70.27804, Best Loss: 0.004283384 at epoch 7
Time Elasped: 00:02:33
========= Epoch 10 =========
134/268: Matthews 0.27901, Accuracy: 68.26462, Loss: 0.004298910
268/268: Matthews 0.29173, Accuracy: 68.07287, Loss: 0.004352267
 
Best Matthews: 0.30126, Best Accuracy: 70.27804, Best Loss: 0.004283384 at epoch 7
Time Elasped: 00:02:48
========= Epoch 11 =========
134/268: Matthews 0.27986, Accuracy: 68.07287, Loss: 0.004346267
268/268: Matthews 0.30602, Accuracy: 67.11409, Loss: 0.004395084
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:03:04
========= Epoch 12 =========
134/268: Matthews 0.30212, Accuracy: 67.78523, Loss: 0.004373549
268/268: Matthews 0.28655, Accuracy: 67.11409, Loss: 0.004457440
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:03:20
========= Epoch 13 =========
134/268: Matthews 0.29927, Accuracy: 66.25120, Loss: 0.004444923
268/268: Matthews 0.27370, Accuracy: 68.64813, Loss: 0.004513705
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:03:35
========= Epoch 14 =========
134/268: Matthews 0.29489, Accuracy: 66.34708, Loss: 0.004482856
268/268: Matthews 0.28915, Accuracy: 66.63471, Loss: 0.004469990
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:03:50
========= Epoch 15 =========
134/268: Matthews 0.28097, Accuracy: 67.97699, Loss: 0.004416308
268/268: Matthews 0.29346, Accuracy: 66.34708, Loss: 0.004475636
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:04:05
========= Epoch 16 =========
134/268: Matthews 0.28138, Accuracy: 67.40173, Loss: 0.004482423
268/268: Matthews 0.30081, Accuracy: 66.15532, Loss: 0.004547796
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:04:20
========= Epoch 17 =========
134/268: Matthews 0.28249, Accuracy: 68.07287, Loss: 0.004585351
268/268: Matthews 0.29369, Accuracy: 67.49760, Loss: 0.004469818
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:04:35
========= Epoch 18 =========
134/268: Matthews 0.29787, Accuracy: 67.59348, Loss: 0.004420387
268/268: Matthews 0.28194, Accuracy: 68.83988, Loss: 0.004467446
 
Best Matthews: 0.30602, Best Accuracy: 67.11409, Best Loss: 0.004395084 at epoch 11
Time Elasped: 00:04:51
========= Epoch 19 =========
134/268: Matthews 0.30746, Accuracy: 67.01822, Loss: 0.004621439
268/268: Matthews 0.31063, Accuracy: 66.53883, Loss: 0.004549146
 
Best Matthews: 0.31063, Best Accuracy: 66.53883, Best Loss: 0.004549146 at epoch 19
Time Elasped: 00:05:09
========= Epoch 20 =========
134/268: Matthews 0.30088, Accuracy: 69.60690, Loss: 0.004461813
268/268: Matthews 0.29659, Accuracy: 67.68936, Loss: 0.004523425
 
Best Matthews: 0.31063, Best Accuracy: 66.53883, Best Loss: 0.004549146 at epoch 19
Time Elasped: 00:05:24
========= Epoch 21 =========
134/268: Matthews 0.29306, Accuracy: 68.07287, Loss: 0.004471822
268/268: Matthews 0.28597, Accuracy: 68.45638, Loss: 0.004561114
 
Best Matthews: 0.31063, Best Accuracy: 66.53883, Best Loss: 0.004549146 at epoch 19
Time Elasped: 00:05:39
========= Epoch 22 =========
134/268: Matthews 0.29292, Accuracy: 68.64813, Loss: 0.004436476
268/268: Matthews 0.28085, Accuracy: 66.82646, Loss: 0.004585418
 
Best Matthews: 0.31063, Best Accuracy: 66.53883, Best Loss: 0.004549146 at epoch 19
Time Elasped: 00:05:54
========= Epoch 23 =========
134/268: Matthews 0.28531, Accuracy: 68.16874, Loss: 0.004498810
268/268: Matthews 0.29277, Accuracy: 67.88111, Loss: 0.004509427
 
Best Matthews: 0.31063, Best Accuracy: 66.53883, Best Loss: 0.004549146 at epoch 19
Time Elasped: 00:06:09
========= Epoch 24 =========
134/268: Matthews 0.28951, Accuracy: 67.40173, Loss: 0.004430335
268/268: Matthews 0.28262, Accuracy: 68.64813, Loss: 0.004468589
 
Best Matthews: 0.31063, Best Accuracy: 66.53883, Best Loss: 0.004549146 at epoch 19
Time Elasped: 00:06:25
========= Epoch 25 =========
134/268: Matthews 0.27722, Accuracy: 68.55225, Loss: 0.004527267
268/268: Matthews 0.29112, Accuracy: 69.31927, Loss: 0.004431192
 
Best Matthews: 0.31063, Best Accuracy: 66.53883, Best Loss: 0.004549146 at epoch 19
Time Elasped: 00:06:40
========= Epoch 26 =========
134/268: Matthews 0.29425, Accuracy: 69.79866, Loss: 0.004453237
268/268: Matthews 0.31272, Accuracy: 68.74401, Loss: 0.004455011
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:06:56
========= Epoch 27 =========
134/268: Matthews 0.27941, Accuracy: 68.83988, Loss: 0.004495586
268/268: Matthews 0.29903, Accuracy: 67.20997, Loss: 0.004473657
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:07:12
========= Epoch 28 =========
134/268: Matthews 0.28828, Accuracy: 69.22339, Loss: 0.004386525
268/268: Matthews 0.30184, Accuracy: 68.55225, Loss: 0.004577870
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:07:27
========= Epoch 29 =========
134/268: Matthews 0.30054, Accuracy: 67.49760, Loss: 0.004432476
268/268: Matthews 0.29187, Accuracy: 68.74401, Loss: 0.004396476
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:07:42
========= Epoch 30 =========
134/268: Matthews 0.29659, Accuracy: 67.68936, Loss: 0.004381045
268/268: Matthews 0.30644, Accuracy: 66.34708, Loss: 0.004440975
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:07:57
========= Epoch 31 =========
134/268: Matthews 0.29626, Accuracy: 67.20997, Loss: 0.004457343
268/268: Matthews 0.28282, Accuracy: 69.41515, Loss: 0.004427903
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:08:12
========= Epoch 32 =========
134/268: Matthews 0.29292, Accuracy: 68.64813, Loss: 0.004348405
268/268: Matthews 0.29471, Accuracy: 68.26462, Loss: 0.004371833
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:08:28
========= Epoch 33 =========
134/268: Matthews 0.30447, Accuracy: 68.55225, Loss: 0.004377345
268/268: Matthews 0.28750, Accuracy: 68.55225, Loss: 0.004295181
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:08:43
========= Epoch 34 =========
134/268: Matthews 0.30896, Accuracy: 66.82646, Loss: 0.004492315
268/268: Matthews 0.27942, Accuracy: 66.73058, Loss: 0.004329531
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:08:58
========= Epoch 35 =========
134/268: Matthews 0.28787, Accuracy: 67.01822, Loss: 0.004387594
268/268: Matthews 0.26803, Accuracy: 69.12752, Loss: 0.004341807
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:09:13
========= Epoch 36 =========
134/268: Matthews 0.28574, Accuracy: 68.36050, Loss: 0.004450111
268/268: Matthews 0.30637, Accuracy: 67.97699, Loss: 0.004421083
 
Best Matthews: 0.31272, Best Accuracy: 68.74401, Best Loss: 0.004455011 at epoch 26
Time Elasped: 00:09:28
========= Epoch 37 =========
134/268: Matthews 0.32225, Accuracy: 65.19655, Loss: 0.004509132
268/268: Matthews 0.29489, Accuracy: 68.36050, Loss: 0.004329371
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:09:45
========= Epoch 38 =========
134/268: Matthews 0.29469, Accuracy: 68.83988, Loss: 0.004337679
268/268: Matthews 0.28951, Accuracy: 67.40173, Loss: 0.004295043
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:10:00
========= Epoch 39 =========
134/268: Matthews 0.29233, Accuracy: 67.49760, Loss: 0.004339465
268/268: Matthews 0.28986, Accuracy: 68.45638, Loss: 0.004343465
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:10:15
========= Epoch 40 =========
134/268: Matthews 0.28792, Accuracy: 67.11409, Loss: 0.004344630
268/268: Matthews 0.30125, Accuracy: 65.77181, Loss: 0.004391941
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:10:31
========= Epoch 41 =========
134/268: Matthews 0.29706, Accuracy: 68.07287, Loss: 0.004408440
268/268: Matthews 0.29833, Accuracy: 68.74401, Loss: 0.004357147
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:10:46
========= Epoch 42 =========
134/268: Matthews 0.28834, Accuracy: 68.36050, Loss: 0.004435683
268/268: Matthews 0.30243, Accuracy: 69.31927, Loss: 0.004345911
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:11:01
========= Epoch 43 =========
134/268: Matthews 0.28388, Accuracy: 67.20997, Loss: 0.004347658
268/268: Matthews 0.30134, Accuracy: 68.26462, Loss: 0.004293482
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:11:16
========= Epoch 44 =========
134/268: Matthews 0.29902, Accuracy: 68.45638, Loss: 0.004382128
268/268: Matthews 0.29399, Accuracy: 68.55225, Loss: 0.004391690
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:11:31
========= Epoch 45 =========
134/268: Matthews 0.31024, Accuracy: 67.49760, Loss: 0.004383986
268/268: Matthews 0.28091, Accuracy: 66.92234, Loss: 0.004353499
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:11:46
========= Epoch 46 =========
134/268: Matthews 0.30511, Accuracy: 64.62128, Loss: 0.004444236
268/268: Matthews 0.29172, Accuracy: 69.12752, Loss: 0.004396584
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:12:02
========= Epoch 47 =========
134/268: Matthews 0.29795, Accuracy: 67.68936, Loss: 0.004498796
268/268: Matthews 0.28363, Accuracy: 68.55225, Loss: 0.004418574
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:12:17
========= Epoch 48 =========
134/268: Matthews 0.30637, Accuracy: 67.97699, Loss: 0.004415601
268/268: Matthews 0.26058, Accuracy: 68.83988, Loss: 0.004440466
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:12:32
========= Epoch 49 =========
134/268: Matthews 0.29978, Accuracy: 65.77181, Loss: 0.004462852
268/268: Matthews 0.28030, Accuracy: 68.26462, Loss: 0.004416246
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:12:47
========= Epoch 50 =========
134/268: Matthews 0.30408, Accuracy: 65.86769, Loss: 0.004550314
268/268: Matthews 0.29574, Accuracy: 68.74401, Loss: 0.004442147
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:13:02
========= Epoch 51 =========
134/268: Matthews 0.28985, Accuracy: 68.93576, Loss: 0.004331570
268/268: Matthews 0.28329, Accuracy: 69.22339, Loss: 0.004403660
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:13:17
========= Epoch 52 =========
134/268: Matthews 0.29954, Accuracy: 65.96357, Loss: 0.004458890
268/268: Matthews 0.30042, Accuracy: 66.82646, Loss: 0.004437853
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:13:33
========= Epoch 53 =========
134/268: Matthews 0.29339, Accuracy: 68.26462, Loss: 0.004483868
268/268: Matthews 0.29903, Accuracy: 67.20997, Loss: 0.004467798
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:13:48
========= Epoch 54 =========
134/268: Matthews 0.30771, Accuracy: 64.81304, Loss: 0.004524615
268/268: Matthews 0.28117, Accuracy: 68.07287, Loss: 0.004431797
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:14:03
========= Epoch 55 =========
134/268: Matthews 0.28986, Accuracy: 68.45638, Loss: 0.004530583
268/268: Matthews 0.29871, Accuracy: 65.48418, Loss: 0.004533466
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:14:18
========= Epoch 56 =========
134/268: Matthews 0.29636, Accuracy: 67.40173, Loss: 0.004537219
268/268: Matthews 0.30321, Accuracy: 67.01822, Loss: 0.004569680
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:14:34
========= Epoch 57 =========
134/268: Matthews 0.29009, Accuracy: 67.88111, Loss: 0.004464383
268/268: Matthews 0.28961, Accuracy: 67.49760, Loss: 0.004599156
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:14:49
========= Epoch 58 =========
Early Stopping activated
 
Best Matthews: 0.32225, Best Accuracy: 65.19655, Best Loss: 0.004509132 at epoch 37
Time Elasped: 00:14:58
Test Set:
0/0: Matthews 0.32225, Accuracy: 65.19655, Loss: 0.004509132
